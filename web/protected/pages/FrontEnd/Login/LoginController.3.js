var PageJs=new Class.create();PageJs.prototype=Object.extend(new FrontPageJs(),{login:function(b){var a={};a.me=this;a.panel=$(b).up(".LoginPanel");a.usernamebox=a.panel.down(".username");a.passwordbox=a.panel.down(".password");if(a.me._preSubmit(a.usernamebox,a.passwordbox)===false){return}a.loadingMsg=new Element("div",{"class":"loadingMsg"}).update("log into system ...");a.me.postAjax(a.me.getCallbackId("login"),{username:$F(a.usernamebox),password:$F(a.passwordbox)},{onLoading:function(){$(b).hide().insert({after:a.loadingMsg})},onComplete:function(c,f){try{a.result=a.me.getResp(f,false,true);if(a.result.url){window.location=a.result.url}}catch(d){$(a.usernamebox).select();a.panel.down(".msgpanel").update(a.me._getErrMsg(d))}a.loadingMsg.remove();$(b).show()}},60000)},_preSubmit:function(c,a){var b={};b.me=this;$$(".errmsg").each(function(d){d.remove()});if($F(c).blank()){$(c).insert({after:b.me._getErrMsg("Please provide an username!")});$(c).focus();return false}if($F(a).blank()){$(a).insert({after:b.me._getErrMsg("Please provide an password!")});$(a).focus();return false}return true},_getErrMsg:function(a){return new Element("span",{"class":"errmsg smalltxt"}).update(a)}});